name: CI/CD RETTA App

on:
  push:
    branches:
      - main # ou "master", se vocÃª estiver usando esse nome

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ”„ Clonar repositÃ³rio
        uses: actions/checkout@v3

      - name: ğŸ³ Configurar Docker Compose
        run: |
          docker-compose -f docker-compose.yml up -d --build

      - name: ğŸ“¦ Instalar dependÃªncias do Laravel
        run: |
          docker exec jobs_RETTA composer install
          docker exec jobs_RETTA php artisan key:generate
          docker exec jobs_RETTA php artisan migrate --force

      - name: âœ… Verificar serviÃ§os
        run: docker ps

      - name: ğŸ§ª Testes backend (Laravel)
        run: docker exec jobs_RETTA php artisan test

      - name: ğŸš€ Deploy finalizado com sucesso
        run: echo "Deploy concluÃ­do com sucesso!"
